<!doctype html>
<html class="h-100">
<!----описание----
комнаты вписываются в файл ui.rooms.json в виде JSON строки
пример файла ui.rooms.json
(id комнат должны быть уникальны)

[
{"id": 0, "title":"Режимы"},
{"id": 1, "title":"Гостиная"},
{"id": 2, "title":"Кухня"},
{"id": 3, "title":"Спальня"},
{"id": 4, "title":"Ванная"},
{"id": 5, "title":"Коридор"},
{"id": 6, "title":"Лоджия"}
]

Устройства, выводимые в интерфейс, размещаются в файле ui.devices.json в виде JSON строки.

id - id девайса (уникальные во всём списке)
room_id - id комнаты из списка выше
ieee - ieeeAddr со страницы девайсов (object для использования объектов)
prop - свойство, которое будет выводиться/управляться данным элементом (имя объекта, для использования совместно с object)
title - заголовок девайса
type - тип устройства (пока в наличии 4 типа):
-- sensor - обыкновенный цифровой сенсор
-- bin-sensor - двоичный сенсор (true/false дд, датчик положения, дачик открытия)
-- value - любой сенсор с текстовым значением
-- switch - тумблер
-- dimmer - слайдер
-- custom-switch - группа переключателей с заданными значениями
icon - иконка девайса (пока поддерживается для sensor, bin-sensor, иконки брать тут https://fontawesome.com/v4.7.0/icons/)
unit - единица измерения (для типа sensor)
sw_type - тип выключателя (для типа switch)
-- normal (default, ON/OFF)
-- bool (true/false)
-- bin (1/0)
-- openable (OPEN/CLOSE)
min - минимальное значение (для типа dimmer)
max - максимальное значение (для типа dimmer)
values - массив объектов (для типа custom-switch)
-- name - имя на кнопке
-- toSet - значение, которое будет передано в свойство (указанное в prop) при нажатии

пример файла ui.devices.json
[
{"id": 1, "room_id":0, "ieee":"object", "prop":"gateway.security.status", "title":"Режим охраны", "type":"switch"},
{"id": 2, "room_id":0, "ieee":"object", "prop":"gateway.eco.status", "title":"Режим экономии", "type":"switch"},
{"id": 3, "room_id":0, "ieee":"object", "prop":"gateway.motion.status", "title":"Режим датчиков движения", "type":"custom-switch", "values":[{"name":"AUTO", "toSet":"auto"},{"name":"ECO", "toSet":"eco"},{"name":"OFF", "toSet":"off"}]},
{"id": 11, "room_id":1, "ieee":"0x00158D00023D2E19", "prop":"temperature", "title":"Температура", "type":"sensor", "icon":"fa-thermometer-full", "unit":"°C"},
{"id": 12, "room_id":1, "ieee":"0x00158D00023D2E19", "prop":"humidity", "title":"Влажность", "type":"sensor", "icon":"fa-tint", "unit":"%"},
{"id": 13, "room_id":1, "ieee":"0x00158D0004863605", "prop":"state_right", "title":"Свет", "type":"switch"},
{"id": 14, "room_id":1, "ieee":"0x00158D000396432E", "prop":"occupancy", "title":"Движение", "type":"bin-sensor", "icon":"fa-male", "unit":"%"},
{"id": 21, "room_id":2, "ieee":"0x00124B001D43CE20", "prop":"state", "title":"Подсветка шкафа", "type":"switch"},
{"id": 22, "room_id":2, "ieee":"0x00124B001D43CE20", "prop":"brightness", "title":"Яркость подсветки шкафа", "type":"dimmer", "min":0, "max":255},
{"id": 23, "room_id":2, "ieee":"0x00124B001D43CE20", "prop":"brightness", "title":"Яркость подсветки шкафа", "type":"custom-switch", "values":[{"name":"0 %", "toSet":0},{"name":"30 %", "toSet":70},{"name":"60 %", "toSet":140},{"name":"100 %", "toSet":255}]}
]

Настройки (цвета карточек, текста и фона, а так же навигационные ссылки хранятся в файле ui.settings.json (автоматически генерируется при первом сохранении настроек из интерфейса)
{"main_bg":"bg-secondary","body_shadow":"","card_text":"text-light","card_theme":"bg-dark", "nav_links":[{"name":"SLSAdmin", "href":"/"},{"name":"Устройства", "href":"/zigbee"}]}

----описание---->
<head>
	<meta charset="utf-8"><title>SLS UI</title><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no">
	<meta name="description" content="SLS UI"><link rel="icon" href="https://cdn.slsys.io/assets/2021.01.10d1/favicon.png" type="image/x-icon">

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
	
	<!--можно скачать к себе, чтобы грузилось локально...да и то что выше, в принципе тоже-->
	<script defer="defer" src="https://cdn.slsys.io/assets/slsui/js/main.707e8930.js"></script>
	<link href="https://cdn.slsys.io/assets/slsui/css/main.65e029e8.css" rel="stylesheet">

</head>

<body id="page-top" class="bg-dark body_shadow h-100"><main role="main"><div id="room_application"></div></main>
<script type="text/javascript">
function c(){var a8=['DOMContent','getElement','\x20\x09<i\x20class','console','false','settings-b','ById',':81/log','234AxjnwF','checked','tton\x22>\x0a\x20\x20\x20','ont-val','sw_type','24BOwmWB','card_theme','6721975HtLIEe','bind','<a\x20class=\x22','OFF','rn\x20this\x22)(','OPEN','tState&nam','bool','1047218moyHJG','676NfhxOS','payload','bg-warning','&action=se','est...','FXEiV','&value=','blob','parse','exception','clamation-','12618089tXtbjV','remove','classList','10VpJiAx','data','friendly_n','true','516104BrkSWB','name','value','log','MozWebSock','add','dimmer','bin','category','insertAdja','jkeAK','1310428rbGrIc','ieeeAddr','27xwIizl','send','wss:','map','length','10428vGIlXh','SENSOR','son','ctor(\x22retu','constructo','toString','stringify','open','\x20Data:\x20','protocol','\x22fa\x20','150196BAYeSm','ieee','change','1FFyCdA','main_bg','prop','dev_','{}.constru','__proto__','type','\x20</a></li>','zigbee','normal','bg-danger','XJBrK'];c=function(){return a8;};return c();}function d(a,b){var e=c();return d=function(f,g){f=f-0x159;var h=e[f];return h;},d(a,b);}(function(a,b){function N(a,b){return d(b- -0x389,a);}var e=a();while(!![]){try{var f=parseInt(N(-0x218,-0x1ee))/0x1*(parseInt(N(-0x243,-0x221))/0x2)+-parseInt(N(-0x228,-0x201))/0x3*(parseInt(N(-0x1e5,-0x1f1))/0x4)+-parseInt(N(-0x217,-0x229))/0x5+-parseInt(N(-0x246,-0x22b))/0x6*(parseInt(N(-0x20f,-0x203))/0x7)+parseInt(N(-0x1f7,-0x20e))/0x8*(parseInt(N(-0x251,-0x230))/0x9)+parseInt(N(-0x217,-0x212))/0xa*(parseInt(N(-0x218,-0x215))/0xb)+-parseInt(N(-0x212,-0x1fc))/0xc*(-parseInt(N(-0x238,-0x220))/0xd);if(f===b)break;else e['push'](e['shift']());}catch(g){e['push'](e['shift']());}}}(c,0xeae22));var dev_arr=JSON['parse'](httpGet('/api/files'+'?path=/ui.'+'devices.js'+'on'));document['addEventLi'+'stener'](O(0x47e,0x489)+'Loaded',function(a){function P(a,b){return O(b,a- -0x5e7);}var b=JSON['parse'](httpGet('/api/files'+'?path=/ui.'+'settings.j'+P(-0x176,-0x183))),e=JSON[P(-0x194,-0x1a8)](httpGet('/api/zigbe'+'e/devices'));for(let h=0x0;h<0x8;h++){document['getElement'+P(-0x158,-0x15c)]('settings-t'+'heme-val'+h)['value']==b[P(-0x1a6,-0x1c9)]&&(document['getElement'+P(-0x158,-0x16c)]('settings-t'+'heme-val'+h)['checked']=!![]),document[P(-0x15d,-0x188)+P(-0x158,-0x143)]('settings-f'+P(-0x1a9,-0x183)+h)['value']==b['card_text']&&(document['getElement'+P(-0x158,-0x13e)]('settings-f'+'ont-val'+h)['checked']=!![]),document['getElement'+'ById'](P(-0x159,-0x13a)+'g-val'+h)[P(-0x188,-0x182)]==b['main_bg']&&(P(-0x15f,-0x188)!==P(-0x15f,-0x13c)?e['getElement'+'ById']('dev_'+f['id'])['checked']=![]:document['getElement'+P(-0x158,-0x13a)]('settings-b'+'g-val'+h)['checked']=!![]);}for(let k=0x0;k<0x2;k++){document['getElement'+P(-0x158,-0x140)]('settings-s'+'hadow-val'+k)[P(-0x188,-0x15e)]==b['body_shado'+'w']&&(document[P(-0x15d,-0x144)+'ById']('settings-s'+'hadow-val'+k)['checked']=!![]);}let f=document['getElement'+'ById']('page-top');b[P(-0x169,-0x14b)]&&(f[P(-0x18f,-0x189)]['remove']('bg-dark'),f['classList']['add'](b['main_bg']));b['body_shado'+'w']==P(-0x15a,-0x165)&&f['classList']['remove']('body_shado'+'w');var g=0x0;e['forEach'](function(l){if(l['st']['battery']){if(l['st']['battery']<0x28){let o='fa-battery'+'-quarter',p='bg-warning';text='battery\x20'+l['st']['battery']+'\x20%';if(l['st']['battery']<0xf){o='fa-battery'+'-empty',p='bg-danger',text='battery\x20lo'+'w';var m=0x1;}content='<li>\x0a\x20\x20\x20\x20\x09'+Q(0x541,0x544)+'dropdown-i'+'tem\x20'+p+('\x22\x20type=\x22bu'+Q(0x53a,0x559)+Q(0x588,0x58d)+'=\x22fa\x20fa-ex'+Q(0x552,0x571)+'triangle\x22\x20'+'aria-hidde'+'n=\x22true\x22><'+'/i>\x20')+l[Q(0x558,0x55b)+'ame']+('\x20<i\x20class='+Q(0x576,0x584))+o+('\x22\x20aria-hid'+'den=\x22true\x22'+'>\x0a\x20\x20\x20\x20\x20\x20\x20\x20'+'</i>\x20')+text+Q(0x581,0x58b),g++;let q=document[Q(0x587,0x57e)+Q(0x58c,0x570)]('panel_aler'+'ts');q[Q(0x563,0x561)+'centHTML']('beforeend',content);}}let n=document['getElement'+'ById']('panel_aler'+'ts_count');function Q(a,b){return P(a-0x6e4,b);}n['innerHTML']=g,g>0x0&&(m==0x1?n['classList']['add'](Q(0x584,0x55d)):n[Q(0x555,0x52d)][Q(0x55f,0x54c)]('bg-warning'));}),dev_arr['forEach'](function(l){function R(a,b){return P(a-0x2d,b);}if(l['type']=='switch'){if(!l['sw_type'])l[R(-0x17b,-0x175)]=R(-0x134,-0x112);if(l['sw_type']=='normal')document['getElement'+'ById'](R(-0x13a,-0x119)+l['id'])['addEventLi'+'stener']('change',function(){function S(a,b){return R(a- -0xc2,b);}'QsYmc'!=='rUGmS'?this['checked']?httpReq(l[S(-0x201,-0x1f3)],l['prop'],'ON'):httpReq(l['ieee'],l['prop'],S(-0x237,-0x24b)):e[S(-0x1f2,-0x1fb)+'ById']('dev_'+f['id'])['checked']=!![];});else{if(l['sw_type']=='bool')document['getElement'+'ById']('dev_'+l['id'])['addEventLi'+'stener']('change',function(){function T(a,b){return R(a-0x460,b);}this[T(0x2e2,0x2fb)]?httpReq(l['ieee'],l['prop'],T(0x302,0x2e1)):T(0x30d,0x2e5)==='tgJsC'?e['getElement'+T(0x335,0x326)]('dev_'+f['id'])[T(0x2e2,0x30b)]=![]:httpReq(l['ieee'],l['prop'],T(0x333,0x357));});else{if(l[R(-0x17b,-0x18e)]==R(-0x156,-0x149))document[R(-0x130,-0x147)+'ById']('dev_'+l['id'])['addEventLi'+'stener']('change',function(){this['checked']?httpReq(l['ieee'],l['prop'],'1'):httpReq(l['ieee'],l['prop'],'0');});else l['sw_type']=='openable'&&document['getElement'+'ById']('dev_'+l['id'])['addEventLi'+'stener']('change',function(){function U(a,b){return R(b-0x361,a);}this['checked']?httpReq(l[U(0x22f,0x222)],l[U(0x20a,0x226)],U(0x20a,0x1ee)):httpReq(l['ieee'],l['prop'],'CLOSE');});}}}l[R(-0x137,-0x159)]=='dimmer'&&('PTPlO'==='vyHSt'?e['getElement'+'ById']('dev_'+f['id'])['checked']=!![]:document[R(-0x130,-0x113)+R(-0x12b,-0x12e)](R(-0x13a,-0x124)+l['id'])['addEventLi'+'stener']('change',function(){function V(a,b){return R(b-0x619,a);}httpReq(l['ieee'],l['prop'],this[V(0x4d5,0x4be)]);})),l['type']=='custom-swi'+'tch'&&('UzzVj'!=='EZIIu'?l['values'][R(-0x14d,-0x178)]((n,o)=>{function W(a,b){return R(a-0x611,b);}'Pgoie'==='Pgoie'?document['getElement'+'ById']('dev_'+l['id']+'_'+o)['addEventLi'+'stener'](W(0x4d3,0x4ec),function(){function X(a,b){return W(a- -0x90,b);}httpReq(l['ieee'],l[X(0x446,0x44d)],n['toSet']);}):h['getElement'+'ById']('dev_'+i['id'])['addEventLi'+'stener'](W(0x4d3,0x4bc),function(){m(n['ieee'],o['prop'],this['value']);});}):b='wss:');}),startWebSockets();});function devUpdate(a){dev_arr['forEach'](function(b){a['payload']['ieeeAddr']==b['ieee']&&a['payload'][Y(0x239,0x227)]==b['prop']&&b[Y(0x242,0x24c)]=='sensor'&&(document['getElement'+'ById']('dev_'+b['id'])['innerHTML']=a['payload']['value']);a['payload']['ieeeAddr']==b['ieee']&&a['payload']['name']==b['prop']&&b['type']=='bin-sensor'&&(console[Y(0x22f,0x229)]('FOUND\x20BIN\x20'+Y(0x22a,0x239)),a['payload']['value']==!![]?(document['getElement'+'ById']('dev_'+b['id'])['classList']['contains']('bg-seconda'+'ry')==!![]&&document['getElement'+Y(0x23a,0x258)](Y(0x25e,0x249)+b['id'])['classList'][Y(0x228,0x220)]('bg-seconda'+'ry'),document['getElement'+'ById'](Y(0x230,0x249)+b['id'])['classList']['add']('bg-warning')):(document['getElement'+'ById'](Y(0x237,0x249)+b['id'])['classList']['contains']('bg-warning')==!![]&&document['getElement'+'ById']('dev_'+b['id'])[Y(0x201,0x221)]['remove']('bg-warning'),document['getElement'+'ById']('dev_'+b['id'])[Y(0x243,0x221)]['add']('bg-seconda'+'ry')));if(a[Y(0x232,0x215)]['ieeeAddr']==b[Y(0x219,0x244)]&&a['payload']['name']==b['prop']&&b[Y(0x234,0x24c)]=='switch'){if(b['sw_type']==Y(0x21f,0x212))a[Y(0x21f,0x215)]['value']=='true'?document['getElement'+'ById']('dev_'+b['id'])['checked']=!![]:document['getElement'+'ById']('dev_'+b['id'])['checked']=![];else{if(b['sw_type']=='bin')a['payload']['value']=='1'?document['getElement'+'ById']('dev_'+b['id'])[Y(0x1f3,0x205)]=!![]:document['getElement'+Y(0x23c,0x258)]('dev_'+b['id'])['checked']=![];else b[Y(0x219,0x208)]=='openable'?a['payload']['value']==Y(0x1ee,0x210)?document['getElement'+'ById'](Y(0x245,0x249)+b['id'])['checked']=!![]:document['getElement'+'ById']('dev_'+b['id'])['checked']=![]:a['payload'][Y(0x20e,0x228)]=='ON'?document['getElement'+'ById']('dev_'+b['id'])['checked']=!![]:document['getElement'+'ById']('dev_'+b['id'])[Y(0x223,0x205)]=![];}}function Y(a,b){return d(b-0xab,a);}a['payload'][Y(0x239,0x232)]==b[Y(0x21b,0x244)]&&a['payload']['name']==b[Y(0x23c,0x248)]&&b['type']=='dimmer'&&(document['getElement'+'ById']('dev_'+b['id'])['value']=a['payload']['value']);if(a['category']=='objects'){if(a['payload']['name']==b['prop']&&b['type']=='switch'){if(b['sw_type']=='bool')a['payload'][Y(0x20d,0x228)]==Y(0x23a,0x225)?document['getElement'+Y(0x282,0x258)]('dev_'+b['id'])['checked']=!![]:document['getElement'+'ById']('dev_'+b['id'])['checked']=![];else{if(b[Y(0x1dd,0x208)]=='bin')a[Y(0x1ff,0x215)]['value']=='1'?document[Y(0x25b,0x253)+'ById'](Y(0x256,0x249)+b['id'])[Y(0x205,0x205)]=!![]:document[Y(0x275,0x253)+'ById']('dev_'+b['id'])['checked']=![];else b['sw_type']=='openable'?a['payload'][Y(0x231,0x228)]=='OPEN'?document['getElement'+Y(0x270,0x258)]('dev_'+b['id'])['checked']=!![]:document['getElement'+'ById'](Y(0x261,0x249)+b['id'])['checked']=![]:a['payload']['value']=='ON'?document['getElement'+Y(0x271,0x258)](Y(0x26f,0x249)+b['id'])[Y(0x201,0x205)]=!![]:document['getElement'+'ById']('dev_'+b['id'])['checked']=![];}a['payload']['name']==b['prop']&&b['type']==Y(0x241,0x22c)&&(document[Y(0x228,0x253)+'ById'](Y(0x24e,0x249)+b['id'])['value']=a['payload']['value']);}}});}var wsTimer=0x0;function O(a,b){return d(b-0x2e2,a);}var startedWebSockets=0x0;function startWebSockets(){var a=window['location'],b;a[Z(0x173,0x16b)]==='https:'?serverUrl=Z(0x164,0x15f):'WwzqT'==='WwzqT'?serverUrl='ws:':k['getElement'+'ById']('dev_'+l['id'])['addEventLi'+'stener']('change',function(){function a0(a,b){return Z(a,b-0xa0);}this[a0(0x1a4,0x1cf)]?y(z['ieee'],A[a0(0x238,0x212)],'1'):B(C['ieee'],D['prop'],'0');});function Z(a,b){return O(a,b- -0x30d);}serverUrl+='//'+a['hostname']+Z(0x161,0x183);try{console[Z(0x131,0x153)]('Conneting\x20'+'to\x20'+serverUrl);if(window[Z(0x168,0x154)+'et'])'OZxvu'!=='OZxvu'?b['classList']['add'](Z(0x15f,0x140)):wsSocket=new MozWebSocket(serverUrl);else window['WebSocket']&&(Z(0x127,0x143)!=='FXEiV'?f(g['ieee'],h['prop'],Z(0x194,0x180)):wsSocket=new WebSocket(serverUrl));}catch(i){return console['log']('Failed\x20con'+'necting\x20to'+'\x20'+serverUrl),![];}wsSocket['binaryType']=Z(0x136,0x145),wsSocket['onopen']=function(j){console[a1(-0x197,-0x1ba)]('WS\x20connect'+'ed\x20(/)');function a1(a,b){return Z(a,b- -0x30d);}startedWebSockets=0x1,clearTimeout(wsTimer),subscribeToDevices();},wsSocket['onmessage']=function(j){console['log']('WS\x20data\x20(/'+')');var k;k=JSON[a2(0x2f9,0x2fa)](j[a2(0x328,0x301)]);function a2(a,b){return Z(a,b-0x1b4);}console['log']('Action:\x20'+k['category']+a2(0x335,0x31e)+JSON['stringify'](k)),devUpdate(k);return;},wsSocket['onclose']=function(j){startedWebSockets=0x0,wsTimer=setTimeout('startWebSo'+'ckets();',0x5*0x3e8),console['log']('WS\x20disconn'+'ected\x20(/)');return;};}function subscribeToDevices(){console['log']('Sending\x20me'+'nu\x20subscri'+'ption\x20requ'+a3(0x15a,0x16f));var a;a=new Object(),a['action']='subscribe',a['category']=a3(0x1cd,0x1a5),wsSocket['send'](JSON['stringify'](a));function a3(a,b){return O(a,b- -0x2e0);}return a[a3(0x17b,0x185)]='objects',wsSocket[a3(0x19a,0x18b)](JSON[a3(0x16f,0x195)](a)),![];}function httpGet(e){var f=(function(){var i=!![];return function(j,k){var l=i?function(){if(k){var m=k['apply'](j,arguments);return k=null,m;}}:function(){};return i=![],l;};}()),g=f(this,function(){var i=function(){var q;function a4(a,b){return d(b-0x1e5,a);}try{q=Function('return\x20(fu'+'nction()\x20'+(a4(0x3a7,0x384)+a4(0x36f,0x375)+a4(0x339,0x349)+'\x20)')+');')();}catch(r){q=window;}return q;},j=i(),k=j[a5(0x29d,0x2b8)]=j['console']||{},l=['log','warn','info','error',a5(0x265,0x247),'table','trace'];function a5(a,b){return d(a-0xf3,b);}for(var m=0x0;m<l[a5(0x27f,0x29c)];m++){var n=f[a5(0x284,0x2ad)+'r']['prototype'][a5(0x254,0x23b)](f),o=l[m],p=k[o]||n;n[a5(0x293,0x2bc)]=f['bind'](f),n[a5(0x285,0x2a5)]=p['toString']['bind'](p),k[o]=n;}});g();function a6(a,b){return O(a,b- -0x256);}console['log']('starting\x20h'+'ttp\x20get');var h=new XMLHttpRequest();h[a6(0x200,0x220)]('GET',e,![]),h['send']();if(h['status']!=0xc8)return![];else{if('ySVER'!=='rTbVQ')return h['responseTe'+'xt'];else f['classList']['add'](a6(0x22c,0x231));}}function httpReq(a,b,e){function a7(a,b){return O(b,a-0x63);}var f=new XMLHttpRequest();return a=='object'?(f['open']('POST','/api/obj?n'+'ame='+b+a7(0x4b4,0x4d9)+e,![]),f[a7(0x4ce,0x4a5)](null),f['responseTe'+'xt']):(f['open']('GET','/api/zigbe'+'e?dev='+a+(a7(0x4b1,0x498)+a7(0x4ab,0x4b3)+'e=')+b+a7(0x4b4,0x4d1)+e,![]),f[a7(0x4ce,0x4d5)](null),f['responseTe'+'xt']);}
</script>
</html>